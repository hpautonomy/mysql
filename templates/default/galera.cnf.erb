
[mysqld]

# mysql settings
binlog_format                  = ROW
default-storage-engine         = innodb
innodb_autoinc_lock_mode       = 2
innodb_doublewrite             = 1
innodb_locks_unsafe_for_binlog = 1
query_cache_size               = 0
query_cache_type               = 0
bind-address                   = 0.0.0.0

# galera settings
wsrep_provider                 = /usr/lib/galera/libgalera_smm.so
wsrep_cluster_name             = <%= node['mysql']['galera']['cluster']['name'] %>
<% if node['mysql']['galera']['cluster']['approach'].eql? 'static' %>
wsrep_cluster_address          = "gcomm://<%= node['mysql']['galera']['cluster']['hosts'].join(',') + ( node['mysql']['galera']['cluster']['garbd']['enabled'] ? ',' + node['mysql']['galera']['cluster']['garbd']['host'] : '' ) %>?pc.wait_prim=no"
<% end %>
wsrep_slave_threads            = <%= node['cpu']['real'] * 2 %>
wsrep_sst_method               = <%= node['mysql']['galera']['cluster']['sst'] %>

[sst]

streamfmt                      = xbstream
progress                       = 1
time                           = 1

